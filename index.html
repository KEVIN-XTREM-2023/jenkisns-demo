<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jenkins Job Configuration</title>
</head>
<body>
    <h1>Configure Jenkins Job</h1>
    <form id="jenkinsForm">
        <label for="jobName">Job Name:</label>
        <input type="text" id="jobName" name="jobName" required><br><br>

        <label for="branch">Git Branch:</label>
        <input type="text" id="branch" name="branch" required><br><br>

        <label for="message">Commit Message:</label>
        <input type="text" id="message" name="message" required><br><br>

        <input type="submit" value="Enviar">
    </form>

    <script>
        document.getElementById('jenkinsForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const jobName = document.getElementById('jobName').value;
            const branch = document.getElementById('branch').value;
            const message = document.getElementById('message').value;

            const xhr = new XMLHttpRequest();
            const url = 'https://f443-45-189-56-196.ngrok-free.app/job/' + jobName + '/demo-pipeline/';
            xhr.open('POST', url, true);
            xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xhr.setRequestHeader('Jenkins-Crumb', 'YOUR_CRUMB_HERE'); // Add your Jenkins crumb here

            const params = 'branch=' + encodeURIComponent(branch) + '&message=' + encodeURIComponent(message);

            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    alert('Build triggered successfully');
                } else if (xhr.readyState === 4) {
                    alert('Failed to trigger build: ' + xhr.statusText);
                }
            };

            xhr.send(params);
        });
    </script>
</body>
</html>
